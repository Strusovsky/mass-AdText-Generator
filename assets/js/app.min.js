var parseStr=function(t,r){return t.replace(/\{\{([\w\.]*)\}\}/g,function(t,n){for(var e=n.split("."),o=r[e.shift()],i=e.length,a=0;i>a;a++)o=o[e[a]];return"undefined"!=typeof o&&null!==o?o:""})},ary2csv=function(t){for(var r=t.length,n=0;r>n;n++)t[n]=t[n].replace(/"/g,'""');return'"'+t.join('","')+'"\n'};$("#addVar").on("click",function(){var t=$("#vars > .row").length,r=$("#templates .row").clone();r.find("label").attr("for","VAR"+t).text("{{VAR"+t+"}}"),r.find("input").attr("id","VAR"+t),r.appendTo("#vars")}),$(document).on("keyup",".var",function(){var t=$(this).val().length,r=$(this).closest(".row");r.find(".col-xs-4").text(""+t),t>35?r.css("color","red"):r.css("color","")}),$("#addGroup").on("click",function(){var t=$("#groups .group:first").clone();t.find("input").val(""),t.appendTo("#groups")}),$("#make").on("click",function(){var t={},r=null,n=!0;if($("#zones textarea").each(function(){var e=$(this).val().split("\n");if(t[$(this).attr("id")]=e,null===r)r=e.length;else if(e.length!==r)return void(n=!1)}),!n)return void alert("Chaque zone de texte doit contenir le mÃªme nombre de lignes (vides ou non vides).");var e={};$("#vars input").each(function(){e[$(this).attr("id")]=$.trim($(this).val())}),$("#report").empty();var o=[];$("#groups .group:first label").each(function(){o.push($(this).text())}),$("#report").append(ary2csv(o));for(var i=0;r>i;i++){for(var a in t)e[a]=t[a][i];$("#groups .group").each(function(){var t=[];$(this).find("input").each(function(){t.push(parseStr($(this).val(),e))}),$("#report").append(ary2csv(t))})}});